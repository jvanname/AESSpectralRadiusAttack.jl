# Here, we use the LSRDR dimensionality reduction and other spectral techniques to evaluate the cryptographic security of the AES block cipher.

using SparseArrays,LinearAlgebra,Statistics,KrylovKit

function unorderedpairsspecrad(table)
n=length(table[1]);
n=256;
m=Int(n*(n-1)/2);
function expand(list) arm=[]; for i in 1:m push!(arm,Int(mat[list[arr[i][1]],list[arr[i][2]]])); end; return arm; end;
xx=spzeros(m,m); for i in 1:1024 xx+=sparse(1:m,expand(table[i]),ones(m)); end;
init=randn(m);
display(abs(KrylovKit.eigsolve(xx,init,2,:LM,krylovdim=30)[1][2]));
end;


encrypttable=[]; for i in 1:256 for j in 1:4 perm=[]; for k in 1:256 x=zeros(UInt8,16); x[1]=UInt8(k-1); SubBytes(x); for ll in 2:16 x[ll]*=0; end; MixColumns(x); push!(perm,1+Int(gadd(UInt8(i-1),x[j])));  end; push!(encrypttable,perm); end; end;

decrypttable=[]; for i in 1:256 for j in 1:4 perm=[]; for k in 1:256 x=zeros(UInt8,16); x[1]=UInt8(k-1); for ll in 2:16 x[ll]*=0; end; InvMixColumns(x); InvSubBytes(x); push!(perm,1+Int(gadd(UInt8(i-1),x[j])));  end; push!(decrypttable,perm); end; end;


# One should get about 45.6864262007241 for unorderedpairsspecrad(encrypttable).
# The ideal value for unorderedpairsspecrad(encrypttable) should be around 32 or smaller.
# The ideal value for unorderedpairsspecrad(encrypttable) given that the mixcolumns polynomial repeats a coefficient should be around sqrt(1536)=39.1918358845... or smaller.

# One should get about 33.5970180369421 for unorderedpairsspecrad(encrypttable).
# The ideal value for unorderedpairsspecrad(encrypttable) should be around 32 or smaller.

# OBSERVATIONS ABOUT THE SECURITY OF AES ROUND FUNCTION.

# If we replace the Rijndael S-box with a random S-box for encryption mode, then we can get a value of about 60 for unorderedpairsspecrad(encrypttable) or so which indicates that the Rijndael S-box is much more secure than
# random S-boxes.





